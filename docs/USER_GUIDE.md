# Lattice 格致 - 用户指南

> 本地优先的科研工作台，专为论文阅读、笔记和代码编辑设计

---

## 目录

1. [快速开始](#快速开始)
2. [核心功能](#核心功能)
3. [PDF 阅读与批注](#pdf-阅读与批注)
4. [Markdown 编辑](#markdown-编辑)
5. [手写笔记](#手写笔记)
6. [代码与 Notebook](#代码与-notebook)
7. [文件管理](#文件管理)
8. [快捷键](#快捷键)
9. [常见问题](#常见问题)

---

## 快速开始

### 安装

**桌面应用（推荐）**

| 平台 | 下载 | 大小 |
|------|------|------|
| Windows | [下载安装包](https://github.com/tryandaction/lattice/releases/latest) | ~6 MB |
| macOS | 即将推出 | - |
| Linux | 即将推出 | - |

**Android 平板/手机**

1. 用 Chrome 浏览器访问 https://lattice-apq.pages.dev/
2. 点击弹出的「安装」提示，或点击菜单 → 「添加到主屏幕」
3. 从主屏幕启动，获得全屏 App 体验
4. 支持完整的文件夹访问和编辑功能

**在线版**

直接访问：https://lattice-apq.pages.dev/

### 首次使用

1. 启动应用
2. 点击「Open Local Folder」选择工作目录
3. 在文件树中双击文件打开
4. 开始阅读、编辑或批注

---

## 核心功能

### 支持的文件格式

| 格式 | 功能 |
|------|------|
| **PDF** | 阅读、高亮、区域选择、文字批注、评论 |
| **Markdown** | 实时预览编辑、Wiki 链接、大纲导航 |
| **手写笔记** (.ink) | 手写绘图、多种笔刷、图层管理 |
| **Jupyter Notebook** | 查看、编辑、运行 Python 代码 |
| **PowerPoint** | 幻灯片预览 |
| **Word** | 文档预览 |
| **图片** | PNG, JPG, GIF, SVG 等 |
| **代码** | 语法高亮、多语言支持 |

### 界面布局

```
┌─────────────────────────────────────────────────────────┐
│  [文件] [编辑] [视图]                    [设置] [帮助]  │
├──────────┬──────────────────────────────────────────────┤
│          │  [标签页1] [标签页2] [+]                     │
│  文件树  │ ┌──────────────────────────────────────────┐ │
│          │ │                                          │ │
│  📁 项目 │ │              主编辑区域                   │ │
│  ├─ 📄   │ │                                          │ │
│  ├─ 📄   │ │                                          │ │
│  └─ 📁   │ │                                          │ │
│          │ └──────────────────────────────────────────┘ │
└──────────┴──────────────────────────────────────────────┘
```

---

## PDF 阅读与批注

### 工具栏

| 工具 | 图标 | 功能 |
|------|------|------|
| 选择 | 🖱️ | 点击批注进行编辑 |
| 高亮 | 🖍️ | 选中文字添加高亮 |
| 区域 | ⬜ | 框选区域添加标记 |
| 文字 | T | 点击添加文字批注 |

### 高亮文本

1. 切换到「高亮」模式
2. 用鼠标选中要高亮的文字
3. 选择高亮颜色
4. 点击高亮区域可添加评论

### 区域选择

1. 切换到「区域」模式（或按住 Alt 键）
2. 拖动鼠标框选区域
3. 选择标记颜色
4. 可添加评论说明

### 文字批注

1. 切换到「文字」模式
2. 在页面上点击要添加批注的位置
3. 输入批注内容
4. 可调整颜色、字号

### 缩放控制

| 操作 | 快捷键 |
|------|--------|
| 放大 | Ctrl + + |
| 缩小 | Ctrl + - |
| 重置 | Ctrl + 0 |
| 滚轮缩放 | Ctrl + 滚轮 |

---

## Markdown 编辑

### 实时预览

Lattice 提供类似 Obsidian 的实时预览体验：

- 编辑时自动渲染格式
- 光标所在行显示源码
- 支持 GFM（GitHub Flavored Markdown）

### Wiki 链接

使用 `[[文件名]]` 创建内部链接：

```markdown
参见 [[研究笔记]] 了解更多
```

### 数学公式

行内公式：`$E = mc^2$`

块级公式：
```markdown
$$
\int_0^\infty e^{-x^2} dx = \frac{\sqrt{\pi}}{2}
$$
```

### 代码块

支持语法高亮：

```python
def hello():
    print("Hello, Lattice!")
```

---

## 手写笔记

### 创建手写笔记

1. 右键文件夹 → 新建文件
2. 命名为 `笔记.ink` 或 `笔记.lattice`
3. 双击打开进入手写模式

### 工具栏

| 工具 | 功能 |
|------|------|
| 🖊️ 钢笔 | 平滑笔迹，适合书写 |
| ✏️ 铅笔 | 纹理笔迹，适合素描 |
| 🖍️ 荧光笔 | 半透明，适合标记 |
| 🧹 橡皮擦 | 擦除笔迹 |
| ⭕ 套索 | 选择并移动笔迹 |
| ✋ 平移 | 移动画布 |

### 手势操作（平板）

| 手势 | 功能 |
|------|------|
| 双指捏合 | 缩放画布 |
| 双指拖动 | 平移画布 |
| 双击 | 重置视图 |
| Apple Pencil 双击 | 切换工具 |

### 背景样式

- 空白
- 网格
- 横线
- 点阵

---

## 代码与 Notebook

### Jupyter Notebook

**运行代码**

1. 打开 `.ipynb` 文件
2. 点击代码单元格的「运行」按钮
3. 首次运行会加载 Python 环境（约 20MB）

**快捷键**

| 快捷键 | 功能 |
|--------|------|
| Shift + Enter | 运行并跳转下一单元格 |
| Ctrl + Enter | 运行当前单元格 |
| A | 在上方插入单元格 |
| B | 在下方插入单元格 |
| M | 转为 Markdown |
| Y | 转为代码 |

### 代码文件

支持的语言：Python, JavaScript, TypeScript, Rust, Go, Java, C/C++, HTML, CSS, JSON, YAML 等

功能：
- 语法高亮
- 代码折叠
- 括号匹配
- 行号显示

---

## 文件管理

### 打开文件夹

1. 点击侧边栏「Open Local Folder」
2. 选择包含研究文件的文件夹
3. 授权访问（仅网页版需要）

### 文件操作

| 操作 | 方法 |
|------|------|
| 新建文件 | 右键文件夹 → 新建文件 |
| 新建文件夹 | 右键文件夹 → 新建文件夹 |
| 重命名 | 右键 → 重命名 / F2 |
| 删除 | 右键 → 删除 / Delete |
| 复制路径 | 右键 → 复制路径 |

### 标签页

| 操作 | 方法 |
|------|------|
| 关闭标签 | 点击 × / 中键点击 / Ctrl+W |
| 切换标签 | 点击 / Ctrl+Tab |
| 快速切换 | Ctrl+1~9 |

---

## 快捷键

### 全局

| 快捷键 | 功能 |
|--------|------|
| Ctrl + B | 切换侧边栏 |
| Ctrl + S | 保存文件 |
| Ctrl + W | 关闭标签页 |
| Ctrl + Tab | 下一个标签 |
| Ctrl + Shift + Tab | 上一个标签 |
| Ctrl + , | 打开设置（桌面版）|

### 编辑器

| 快捷键 | 功能 |
|--------|------|
| Ctrl + Z | 撤销 |
| Ctrl + Y | 重做 |
| Ctrl + F | 查找 |
| Ctrl + H | 替换 |
| Ctrl + / | 注释/取消注释 |

### PDF

| 快捷键 | 功能 |
|--------|------|
| Ctrl + + | 放大 |
| Ctrl + - | 缩小 |
| Ctrl + 0 | 重置缩放 |

### 手写

| 快捷键 | 功能 |
|--------|------|
| P | 钢笔工具 |
| N | 铅笔工具 |
| H | 荧光笔 |
| E | 橡皮擦 |
| S | 套索选择 |
| V | 平移工具 |
| Ctrl + Z | 撤销 |
| Ctrl + Y | 重做 |
| Delete | 删除选中 |

---

## 常见问题

### 应用无法启动

**Windows**
- 确保 Windows 10 1803 或更高版本
- 尝试以管理员身份运行
- 检查杀毒软件是否拦截

### 文件无法打开

- 确认文件格式受支持
- 检查文件是否损坏
- 尝试重新打开文件夹

### PDF 批注不显示

- 批注保存在 `.lattice/annotations/` 目录
- 确保有写入权限
- 检查是否在正确的文件夹中打开

### Python 代码无法运行

- 首次运行需要下载 Pyodide 环境（约 20MB）
- 检查网络连接
- 等待加载完成后重试

### 手写延迟

- 确保使用支持压感的触控笔
- 关闭不必要的后台程序
- 尝试降低画布缩放级别

---

## 获取帮助

- **GitHub Issues**: [报告问题](https://github.com/tryandaction/lattice/issues)
- **文档**: [完整文档](https://github.com/tryandaction/lattice)
- **更新日志**: [CHANGELOG.md](../CHANGELOG.md)

---

**享受高效的科研工作流！** 🚀
