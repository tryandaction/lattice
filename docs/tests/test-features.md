# Lattice 功能测试清单

## 🧪 测试前准备

### 环境要求
- [ ] Node.js 18+ 已安装
- [ ] Rust 1.70+ 已安装（桌面应用测试）
- [ ] 依赖已安装 (`npm install`)

### 构建
```bash
# 网页版
npm run build

# 桌面应用
npm run tauri:build
```

## 📋 测试清单

### 1. 网页版功能测试

#### 1.1 下载提醒弹窗
- [ ] 首次访问网页版时，2秒后显示下载提醒弹窗
- [ ] 弹窗显示桌面应用的三大优势
- [ ] 点击"前往下载页面"按钮，跳转到 GitHub Releases
- [ ] 点击"继续使用网页版"按钮，关闭弹窗
- [ ] 勾选"不再显示此提示"后关闭，刷新页面不再显示
- [ ] 清除 localStorage 后，弹窗重新显示

**测试步骤**：
```bash
# 启动开发服务器
npm run dev

# 访问 http://localhost:3000
# 打开浏览器开发者工具 > Application > Local Storage
# 删除 lattice-download-dismissed 键
# 刷新页面，观察弹窗
```

#### 1.2 基本功能
- [ ] 文件浏览器正常显示
- [ ] 可以打开本地文件
- [ ] Markdown 编辑正常
- [ ] PDF 查看正常
- [ ] 代码高亮正常

### 2. 桌面应用功能测试

#### 2.1 安装测试

**Windows**:
- [ ] NSIS 安装包可以正常安装
- [ ] MSI 安装包可以正常安装
- [ ] 安装后可以从开始菜单启动
- [ ] 桌面快捷方式正常工作

**macOS**:
- [ ] DMG 镜像可以正常打开
- [ ] 拖拽到 Applications 文件夹成功
- [ ] 首次运行时可以通过右键"打开"绕过 Gatekeeper

**Linux**:
- [ ] AppImage 添加执行权限后可以运行
- [ ] DEB 包可以正常安装
- [ ] 安装后可以从应用菜单启动

#### 2.2 默认文件夹功能

**设置默认文件夹**:
- [ ] 点击右下角设置按钮，打开设置界面
- [ ] 或按 `Ctrl+,` 打开设置界面
- [ ] 点击"选择文件夹"按钮，弹出文件夹选择对话框
- [ ] 选择一个文件夹后，路径显示在"设置新的默认文件夹"下方
- [ ] 点击"保存"按钮，设置成功
- [ ] "当前默认文件夹"显示刚才设置的路径

**验证默认文件夹**:
- [ ] 关闭应用
- [ ] 重新启动应用
- [ ] 应用自动打开默认文件夹
- [ ] 设置界面中"当前默认文件夹"显示正确

**清除默认文件夹**:
- [ ] 打开设置界面
- [ ] 点击"当前默认文件夹"旁边的垃圾桶图标
- [ ] 默认文件夹被清除，显示"未设置"
- [ ] 关闭并重新启动应用，不再自动打开文件夹

#### 2.3 自动记忆功能

**测试步骤**:
- [ ] 清除默认文件夹设置
- [ ] 打开一个文件夹 A
- [ ] 关闭应用
- [ ] 重新启动应用
- [ ] 设置界面中"上次打开的文件夹"显示文件夹 A
- [ ] 打开另一个文件夹 B
- [ ] 关闭应用
- [ ] 重新启动应用
- [ ] 设置界面中"上次打开的文件夹"显示文件夹 B

#### 2.4 设置持久化

**测试步骤**:
- [ ] 设置默认文件夹
- [ ] 检查设置文件是否存在：
  - Windows: `%APPDATA%\com.lattice.editor\settings.json`
  - macOS: `~/Library/Application Support/com.lattice.editor/settings.json`
  - Linux: `~/.config/com.lattice.editor/settings.json`
- [ ] 打开设置文件，验证内容格式正确
- [ ] 手动编辑设置文件，修改默认文件夹路径
- [ ] 重新启动应用，验证修改生效

#### 2.5 错误处理

**测试步骤**:
- [ ] 设置一个不存在的文件夹路径（手动编辑设置文件）
- [ ] 重新启动应用，观察错误提示
- [ ] 设置一个没有权限的文件夹
- [ ] 观察错误提示是否友好

#### 2.6 基本功能

- [ ] 应用启动速度快（< 2 秒）
- [ ] 窗口大小和位置正确（1400x900）
- [ ] 可以调整窗口大小
- [ ] 文件浏览器正常工作
- [ ] 可以打开本地文件（无需授权）
- [ ] Markdown 编辑正常
- [ ] PDF 查看正常
- [ ] 代码高亮正常
- [ ] 数学公式编辑正常

#### 2.7 快捷键

- [ ] `Ctrl+B` / `Cmd+B` 切换侧边栏
- [ ] `Ctrl+,` / `Cmd+,` 打开设置界面
- [ ] 其他快捷键正常工作

### 3. 文档测试

#### 3.1 README
- [ ] 下载链接清晰可见
- [ ] 平台下载表格格式正确
- [ ] 优势对比表格准确
- [ ] 所有链接可以正常访问

#### 3.2 安装指南
- [ ] 安装步骤清晰
- [ ] 故障排除部分完整
- [ ] 代码示例可以正常运行

#### 3.3 桌面功能指南
- [ ] 功能说明详细
- [ ] 使用步骤清晰
- [ ] 截图（如果有）清晰

#### 3.4 更新日志
- [ ] 版本号正确
- [ ] 变更记录完整
- [ ] 格式符合 Keep a Changelog 标准

### 4. 性能测试

#### 4.1 启动性能
- [ ] 网页版首次加载时间 < 3 秒
- [ ] 桌面应用启动时间 < 2 秒
- [ ] 桌面应用内存占用 < 200 MB

#### 4.2 文件操作性能
- [ ] 打开大文件（> 10 MB）响应时间 < 1 秒
- [ ] 切换文件响应时间 < 500 ms
- [ ] 编辑操作流畅，无卡顿

### 5. 兼容性测试

#### 5.1 浏览器兼容性（网页版）
- [ ] Chrome/Edge 最新版
- [ ] Firefox 最新版
- [ ] Safari 最新版（macOS）

#### 5.2 操作系统兼容性（桌面应用）
- [ ] Windows 10/11
- [ ] macOS 12+
- [ ] Ubuntu 22.04+
- [ ] 其他主流 Linux 发行版

### 6. 发布流程测试

#### 6.1 手动发布
- [ ] 运行 `scripts/prepare-release.sh` 或 `.bat`
- [ ] 版本号更新正确
- [ ] 构建成功
- [ ] 构建产物完整

#### 6.2 自动发布（GitHub Actions）
- [ ] 推送 tag 触发工作流
- [ ] 所有平台构建成功
- [ ] 构建产物上传成功
- [ ] Release 创建成功

## 📊 测试结果

### 测试环境
- 操作系统：
- Node.js 版本：
- Rust 版本：
- 浏览器版本：

### 测试日期
- 开始时间：
- 结束时间：

### 测试结果汇总
- 总测试项：
- 通过：
- 失败：
- 跳过：

### 发现的问题
1. 
2. 
3. 

### 建议改进
1. 
2. 
3. 

## 🔧 调试技巧

### 查看 Tauri 日志
```bash
# 开发模式
npm run tauri:dev

# 生产模式（Windows）
src-tauri\target\release\lattice.exe

# 查看控制台输出
```

### 查看设置文件
```bash
# Windows
type %APPDATA%\com.lattice.editor\settings.json

# macOS/Linux
cat ~/Library/Application\ Support/com.lattice.editor/settings.json
# 或
cat ~/.config/com.lattice.editor/settings.json
```

### 清除设置
```bash
# Windows
del %APPDATA%\com.lattice.editor\settings.json

# macOS
rm ~/Library/Application\ Support/com.lattice.editor/settings.json

# Linux
rm ~/.config/com.lattice.editor/settings.json
```

### 查看浏览器控制台
```
F12 或 Ctrl+Shift+I
```

## 📝 测试报告模板

```markdown
# Lattice v0.1.0 测试报告

## 测试环境
- OS: Windows 11 / macOS 14 / Ubuntu 22.04
- Node.js: v20.x.x
- Rust: v1.70.x
- Browser: Chrome 120.x

## 测试结果
- ✅ 网页版下载提醒：通过
- ✅ 桌面应用安装：通过
- ✅ 默认文件夹设置：通过
- ✅ 自动记忆功能：通过
- ✅ 设置持久化：通过
- ✅ 基本功能：通过

## 发现的问题
无

## 建议
1. 添加更多快捷键
2. 优化启动速度
3. 添加主题切换

## 结论
所有核心功能正常，可以发布。
```

---

**测试愉快！** 🧪
